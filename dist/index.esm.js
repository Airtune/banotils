import"crypto";function n(n){return(4294967296+n).toString(16).substring(1)}var t={normalizeInput:function(n){let t;if(n instanceof Uint8Array)t=n;else if(n instanceof Buffer)t=new Uint8Array(n);else{if("string"!=typeof n)throw new Error("Input must be an string, Buffer or Uint8Array");t=new Uint8Array(Buffer.from(n,"utf8"))}return t},toHex:function(n){return Array.prototype.map.call(n,(function(n){return(n<16?"0":"")+n.toString(16)})).join("")},debugPrint:function(t,r,e){let o="\n"+t+" = ";for(let i=0;i<r.length;i+=2){if(32===e)o+=n(r[i]).toUpperCase(),o+=" ",o+=n(r[i+1]).toUpperCase();else{if(64!==e)throw new Error("Invalid size "+e);o+=n(r[i+1]).toUpperCase(),o+=n(r[i]).toUpperCase()}i%6==4?o+="\n"+new Array(t.length+4).join(" "):i<r.length-2&&(o+=" ")}console.log(o)},testSpeed:function(n,t,r){let e=(new Date).getTime();const o=new Uint8Array(t);for(let n=0;n<t;n++)o[n]=n%256;const i=(new Date).getTime();console.log("Generated random input in "+(i-e)+"ms"),e=i;for(let i=0;i<r;i++){const r=n(o),i=(new Date).getTime(),a=i-e;e=i,console.log("Hashed in "+a+"ms: "+r.substring(0,20)+"..."),console.log(Math.round(t/(1<<20)/(a/1e3)*100)/100+" MB PER SECOND")}}};const r=t;function e(n,t,r){const e=n[t]+n[r];let o=n[t+1]+n[r+1];e>=4294967296&&o++,n[t]=e,n[t+1]=o}function o(n,t,r,e){let o=n[t]+r;r<0&&(o+=4294967296);let i=n[t+1]+e;o>=4294967296&&i++,n[t]=o,n[t+1]=i}function i(n,t){return n[t]^n[t+1]<<8^n[t+2]<<16^n[t+3]<<24}function a(n,t,r,i,a,u){const c=s[a],f=s[a+1],b=s[u],h=s[u+1];e(l,n,t),o(l,n,c,f);let g=l[i]^l[n],p=l[i+1]^l[n+1];l[i]=p,l[i+1]=g,e(l,r,i),g=l[t]^l[r],p=l[t+1]^l[r+1],l[t]=g>>>24^p<<8,l[t+1]=p>>>24^g<<8,e(l,n,t),o(l,n,b,h),g=l[i]^l[n],p=l[i+1]^l[n+1],l[i]=g>>>16^p<<16,l[i+1]=p>>>16^g<<16,e(l,r,i),g=l[t]^l[r],p=l[t+1]^l[r+1],l[t]=p>>>31^g<<1,l[t+1]=g>>>31^p<<1}const u=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),c=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map((function(n){return 2*n}))),l=new Uint32Array(32),s=new Uint32Array(32);function f(n,t){let r=0;for(r=0;r<16;r++)l[r]=n.h[r],l[r+16]=u[r];for(l[24]=l[24]^n.t,l[25]=l[25]^n.t/4294967296,t&&(l[28]=~l[28],l[29]=~l[29]),r=0;r<32;r++)s[r]=i(n.b,4*r);for(r=0;r<12;r++)a(0,8,16,24,c[16*r+0],c[16*r+1]),a(2,10,18,26,c[16*r+2],c[16*r+3]),a(4,12,20,28,c[16*r+4],c[16*r+5]),a(6,14,22,30,c[16*r+6],c[16*r+7]),a(0,10,20,30,c[16*r+8],c[16*r+9]),a(2,12,22,24,c[16*r+10],c[16*r+11]),a(4,14,16,26,c[16*r+12],c[16*r+13]),a(6,8,18,28,c[16*r+14],c[16*r+15]);for(r=0;r<16;r++)n.h[r]=n.h[r]^l[r]^l[r+16]}function b(n,t){if(0===n||n>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(t&&t.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");const r={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:n};for(let n=0;n<16;n++)r.h[n]=u[n];const e=t?t.length:0;return r.h[0]^=16842752^e<<8^n,t&&(h(r,t),r.c=128),r}function h(n,t){for(let r=0;r<t.length;r++)128===n.c&&(n.t+=n.c,f(n,!1),n.c=0),n.b[n.c++]=t[r]}function g(n){for(n.t+=n.c;n.c<128;)n.b[n.c++]=0;f(n,!0);const t=new Uint8Array(n.outlen);for(let r=0;r<n.outlen;r++)t[r]=n.h[r>>2]>>8*(3&r);return t}function p(n,t,e){e=e||64,n=r.normalizeInput(n);const o=b(e,t);return h(o,n),g(o)}var d={blake2b:p,blake2bHex:function(n,t,e){const o=p(n,t,e);return r.toHex(o)},blake2bInit:b,blake2bUpdate:h,blake2bFinal:g};const y=t;function w(n,t){return n[t]^n[t+1]<<8^n[t+2]<<16^n[t+3]<<24}function A(n,t,r,e,o,i){I[n]=I[n]+I[t]+o,I[e]=x(I[e]^I[n],16),I[r]=I[r]+I[e],I[t]=x(I[t]^I[r],12),I[n]=I[n]+I[t]+i,I[e]=x(I[e]^I[n],8),I[r]=I[r]+I[e],I[t]=x(I[t]^I[r],7)}function x(n,t){return n>>>t^n<<32-t}const k=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),v=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),I=new Uint32Array(16),U=new Uint32Array(16);function m(n,t){let r=0;for(r=0;r<8;r++)I[r]=n.h[r],I[r+8]=k[r];for(I[12]^=n.t,I[13]^=n.t/4294967296,t&&(I[14]=~I[14]),r=0;r<16;r++)U[r]=w(n.b,4*r);for(r=0;r<10;r++)A(0,4,8,12,U[v[16*r+0]],U[v[16*r+1]]),A(1,5,9,13,U[v[16*r+2]],U[v[16*r+3]]),A(2,6,10,14,U[v[16*r+4]],U[v[16*r+5]]),A(3,7,11,15,U[v[16*r+6]],U[v[16*r+7]]),A(0,5,10,15,U[v[16*r+8]],U[v[16*r+9]]),A(1,6,11,12,U[v[16*r+10]],U[v[16*r+11]]),A(2,7,8,13,U[v[16*r+12]],U[v[16*r+13]]),A(3,4,9,14,U[v[16*r+14]],U[v[16*r+15]]);for(r=0;r<8;r++)n.h[r]^=I[r]^I[r+8]}function B(n,t){if(!(n>0&&n<=32))throw new Error("Incorrect output length, should be in [1, 32]");const r=t?t.length:0;if(t&&!(r>0&&r<=32))throw new Error("Incorrect key length, should be in [1, 32]");const e={h:new Uint32Array(k),b:new Uint8Array(64),c:0,t:0,outlen:n};return e.h[0]^=16842752^r<<8^n,r>0&&(F(e,t),e.c=64),e}function F(n,t){for(let r=0;r<t.length;r++)64===n.c&&(n.t+=n.c,m(n,!1),n.c=0),n.b[n.c++]=t[r]}function _(n){for(n.t+=n.c;n.c<64;)n.b[n.c++]=0;m(n,!0);const t=new Uint8Array(n.outlen);for(let r=0;r<n.outlen;r++)t[r]=n.h[r>>2]>>8*(3&r)&255;return t}function E(n,t,r){r=r||32,n=y.normalizeInput(n);const e=B(r,t);return F(e,n),_(e)}var S={blake2s:E,blake2sHex:function(n,t,r){const e=E(n,t,r);return y.toHex(e)},blake2sInit:B,blake2sUpdate:F,blake2sFinal:_};var C={blake2b:d.blake2b,blake2bHex:d.blake2bHex,blake2bInit:d.blake2bInit,blake2bUpdate:d.blake2bUpdate,blake2bFinal:d.blake2bFinal,blake2s:S.blake2s,blake2sHex:S.blake2sHex,blake2sInit:S.blake2sInit,blake2sUpdate:S.blake2sUpdate,blake2sFinal:S.blake2sFinal};const G=function(n){let t;const r=new Float64Array(16);if(n)for(t=0;t<n.length;t++)r[t]=n[t];return r};new Uint8Array(32)[0]=9;const H=G(),D=G([1]);G([56129,1]),G([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]);const M=G([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),R=G([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),L=G([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]);function P(n,t){let r;for(r=0;r<16;r++)n[r]=0|t[r]}function W(n){let t,r;for(r=0;r<16;r++)n[r]+=65536,t=Math.floor(n[r]/65536),n[(r+1)*(r<15?1:0)]+=t-1+37*(t-1)*(15===r?1:0),n[r]-=65536*t}function j(n,t,r){let e;const o=~(r-1);for(let r=0;r<16;r++)e=o&(n[r]^t[r]),n[r]^=e,t[r]^=e}function O(n,t){let r,e,o;const i=G(),a=G();for(r=0;r<16;r++)a[r]=t[r];for(W(a),W(a),W(a),e=0;e<2;e++){for(i[0]=a[0]-65517,r=1;r<15;r++)i[r]=a[r]-65535-(i[r-1]>>16&1),i[r-1]&=65535;i[15]=a[15]-32767-(i[14]>>16&1),o=i[15]>>16&1,i[14]&=65535,j(a,i,1-o)}for(r=0;r<16;r++)n[2*r]=255&a[r],n[2*r+1]=a[r]>>8}function T(n,t,r){let e;for(e=0;e<16;e++)n[e]=t[e]+r[e]|0}function $(n,t,r){let e;for(e=0;e<16;e++)n[e]=t[e]-r[e]|0}function N(n,t,r){let e,o;const i=new Float64Array(31);for(e=0;e<31;e++)i[e]=0;for(e=0;e<16;e++)for(o=0;o<16;o++)i[e+o]+=t[e]*r[o];for(e=0;e<15;e++)i[e]+=38*i[e+16];for(e=0;e<16;e++)n[e]=i[e];W(n),W(n)}function V(n,t){N(n,t,t)}function z(n,t){const r=G(),e=G(),o=G(),i=G(),a=G(),u=G(),c=G(),l=G(),s=G();$(r,n[1],n[0]),$(s,t[1],t[0]),N(r,r,s),T(e,n[0],n[1]),T(s,t[0],t[1]),N(e,e,s),N(o,n[3],t[3]),N(o,o,M),N(i,n[2],t[2]),T(i,i,i),$(a,e,r),$(u,i,o),T(c,i,o),T(l,e,r),N(n[0],a,u),N(n[1],l,c),N(n[2],c,u),N(n[3],a,l)}function q(n,t,r){let e;for(e=0;e<4;e++)j(n[e],t[e],r)}function Y(n,t){const r=G(),e=G(),o=G();!function(n,t){const r=G();let e;for(e=0;e<16;e++)r[e]=t[e];for(e=253;e>=0;e--)V(r,r),2!==e&&4!==e&&N(r,r,t);for(e=0;e<16;e++)n[e]=r[e]}(o,t[2]),N(r,t[0],o),N(e,t[1],o),O(n,e),n[31]^=function(n){const t=new Uint8Array(32);return O(t,n),1&t[0]}(r)<<7}function K(n,t){const r=[G(),G(),G(),G()];P(r[0],R),P(r[1],L),P(r[2],D),N(r[3],R,L),function(n,t,r){let e,o;for(P(n[0],H),P(n[1],D),P(n[2],D),P(n[3],H),o=255;o>=0;--o)e=r[o/8|0]>>(7&o)&1,q(n,t,e),z(t,n),z(n,n),q(n,t,e)}(n,r,t)}G([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);const J=n=>{const t=n.length/4*5,r=new Uint8Array(t);for(let e=1;e<=t;e++){const t=e-1,o=e%5,i=t-(e-o)/5,a=n[i-1]<<5-o,u=n[i]>>o;r[t]=(u+a)%16}return r},X=n=>{const t=new Uint8Array(2*n.length);for(let r=0;r<n.length;r++)t[2*r]=n[r]/16|0,t[2*r+1]=n[r]%16;return t},Q=n=>{const t=n.length/2,r=new Uint8Array(t);for(let e=0;e<t;e++)r[e]=16*n[2*e]+n[2*e+1];return r},Z=n=>{const t="13456789abcdefghijkmnopqrstuwxyz".split(""),r=n.length,e=n.split(""),o=new Uint8Array(r);for(let n=0;n<r;n++)o[n]=t.indexOf(e[n]);return o},nn=n=>{const t=new Uint8Array(n.length);for(let r=0;r<n.length;r++)t[r]=parseInt(n.substr(r,1),16);return t},tn=n=>{const t=n.length/5*4,r=new Uint8Array(t);for(let e=1;e<=t;e++){const o=e-1,i=e%4,a=o+(e-i)/4,u=n[a]<<i;let c;c=(t-e)%4==0?n[a-1]<<4:n[a+1]>>4-i,r[o]=(c+u)%32}return r},rn=n=>{const t="13456789abcdefghijkmnopqrstuwxyz".split("");let r="";for(let e=0;e<n.length;e++)r+=t[n[e]];return r},en=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function on(n,t){let r,e,o,i;for(e=63;e>=32;--e){for(r=0,o=e-32,i=e-12;o<i;++o)t[o]+=r-16*t[e]*en[o-(e-32)],r=t[o]+128>>8,t[o]-=256*r;t[o]+=r,t[e]=0}for(r=0,o=0;o<32;o++)t[o]+=r-(t[31]>>4)*en[o],r=t[o]>>8,t[o]&=255;for(o=0;o<32;o++)t[o]-=r*en[o];for(e=0;e<32;e++)t[e+1]+=t[e]>>8,n[e]=255&t[e]}function an(n){const t=new Float64Array(64);let r;for(r=0;r<64;r++)t[r]=n[r];for(r=0;r<64;r++)n[r]=0;on(n,t)}function un(n){let t=new Uint8Array(64);const r=[G(),G(),G(),G()],e=new Uint8Array(32),o=C.blake2bInit(64);return C.blake2bUpdate(o,n),t=C.blake2bFinal(o),t[0]&=248,t[31]&=127,t[31]|=64,K(r,t),Y(e,r),e}function cn(n){let t=n.substring(4,64);const r=(n=>{const t=n.length-1,r=new Uint8Array(t);for(let e=0;e<t;e++)r[e]=n[e+1];return r})(J(Z(t.substring(0,52)))),e=J(Z(t.substring(52,60))),o=Q(r),i=C.blake2b(o,null,5).reverse(),a=e,u=X(i);if(!((n,t)=>{for(let r=0;r<n.length;r++)if(n[r]!=t[r])return!1;return!0})(a,u)){const n=rn(tn(a)),t=rn(tn(u));throw new Error(`Incorrect checksum ${n} != ${t}`)}return function(n){const t=new Uint8Array(n.length/2);for(let r=0;r<t.length;++r)t[r]=parseInt(n.substring(2*r+0,2*r+2),16);return t}((n=>{let t="";for(let r=0;r<n.length;r++)t+=n[r].toString(16).toUpperCase();return t})(r))}function ln(n,t){const r=new Uint8Array(64+t.length);!function(n,t,r,e){let o,i,a=new Uint8Array(64),u=new Uint8Array(64),c=new Uint8Array(64);const l=new Float64Array(64),s=[G(),G(),G(),G()],f=un(e);let b=C.blake2bInit(64,null);C.blake2bUpdate(b,e),a=C.blake2bFinal(b),a[0]&=248,a[31]&=127,a[31]|=64;const h=r+64;for(o=0;o<r;o++)n[64+o]=t[o];for(o=0;o<32;o++)n[32+o]=a[32+o];for(b=C.blake2bInit(64,null),C.blake2bUpdate(b,n.subarray(32)),c=C.blake2bFinal(b),an(c),K(s,c),Y(n,s),o=32;o<64;o++)n[o]=f[o-32];for(b=C.blake2bInit(64,null),C.blake2bUpdate(b,n),u=C.blake2bFinal(b),an(u),o=0;o<64;o++)l[o]=0;for(o=0;o<32;o++)l[o]=c[o];for(o=0;o<32;o++)for(i=0;i<32;i++)l[o+i]+=u[o]*a[i];on(n.subarray(32),l)}(r,t,t.length,n);const e=new Uint8Array(64);for(let n=0;n<e.length;n++)e[n]=r[n];return e}const sn=new RegExp("^[0123456789abcdefABCDEF]{64}$");function fn(n){const t=new Uint8Array(n.length/2);for(let r=0;r<t.length;++r)t[r]=parseInt(n.substring(2*r+0,2*r+2),16);return t}function bn(n){return Array.prototype.map.call(n,(n=>("00"+n.toString(16)).slice(-2))).join("").toUpperCase()}function hn(n,t){const r=n.toString().split(""),e=[];let o="";const i=[];for(;r.length;){let n=1*Number(r.shift());for(let t=0;n||t<e.length;++t)n+=10*(e[t]||0),e[t]=n%16,n=(n-e[t])/16}for(;e.length;)i.push(e.pop().toString(16));if(o=i.join(""),o.length%2!=0&&(o="0"+o),t>o.length/2){const n=t-o.length/2;for(let t=0;t<n;t++)o="00"+o}return o}function gn(n){return sn.test(bn(n))}function pn(n,t,r){const e=C.blake2bInit(8);C.blake2bUpdate(e,t),C.blake2bUpdate(e,n);const o=bn(C.blake2bFinal(e).reverse());return BigInt("0x"+o)>r}function dn(n){const t=n.indexOf(".");let r=BigInt("1");if(-1!==t){const e=(n=n.replace(".","")).length-t;r=BigInt("10")**BigInt(e)}return BigInt(n)*BigInt("100000000000000000000000000000")/r}function yn(n){const t=BigInt("1000000000000000000000000000"),r=BigInt("100000000000000000000000000000"),e=n/r,o=(n-e*r)/t;return e.toString()+"."+o.toString().padStart(2,"0")}function wn(n,t=0){if(!gn(n))throw new Error(`Invalid seed '${n}'`);const r=fn(hn(t,4)),e=C.blake2bInit(32);return C.blake2bUpdate(e,n),C.blake2bUpdate(e,r),C.blake2bFinal(e)}function An(n){return"string"==typeof n?cn(n):un(n)}function xn(n){return function(n){const t=Q(nn(n)),r=rn(tn(X(C.blake2b(t,null,5).reverse())));return`ban_${rn(tn(nn(`0${n}`)))}${r}`}(bn(n))}var kn;!function(n){n[n.SEND=0]="SEND",n[n.RECEIVE=1]="RECEIVE"}(kn||(kn={}));function vn(n,t){let r="";for(let e=t-1;e>-1;e--)r+=(n[e]>15?"":"0")+n[e].toString(16);return r}const In=document.createElement("canvas"),Un=In.getContext("webgl2"),mn=Un.createShader(Un.VERTEX_SHADER);Un.shaderSource(mn,"#version 300 es\nprecision highp float;\n#define GLSLIFY 1\nconst vec2 vertices[4]=vec2[](vec2(-1,+1),vec2(-1,-1),vec2(+1,+1),vec2(+1,-1));void main(){gl_Position=vec4(vertices[gl_VertexID],0.0,1.0);}"),Un.compileShader(mn);const Bn=Un.createShader(Un.FRAGMENT_SHADER);Un.shaderSource(Bn,"#version 300 es\nprecision highp float;precision highp int;\n#define GLSLIFY 1\nout vec4 fragColor;uniform uvec4 uWork0;uniform uvec4 uWork1;uniform uvec4 uHash0;uniform uvec4 uHash1;\n#define BLAKE2B_IV32_1 0x6A09E667u\nuint v[32]=uint[32](0xF2BDC900u,0x6A09E667u,0x84CAA73Bu,0xBB67AE85u,0xFE94F82Bu,0x3C6EF372u,0x5F1D36F1u,0xA54FF53Au,0xADE682D1u,0x510E527Fu,0x2B3E6C1Fu,0x9B05688Cu,0xFB41BD6Bu,0x1F83D9ABu,0x137E2179u,0x5BE0CD19u,0xF3BCC908u,0x6A09E667u,0x84CAA73Bu,0xBB67AE85u,0xFE94F82Bu,0x3C6EF372u,0x5F1D36F1u,0xA54FF53Au,0xADE682F9u,0x510E527Fu,0x2B3E6C1Fu,0x9B05688Cu,0x04BE4294u,0xE07C2654u,0x137E2179u,0x5BE0CD19u);uint m[32];const int SIGMA82[192]=int[192](0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,28,20,8,16,18,30,26,12,2,24,0,4,22,14,10,6,22,16,24,0,10,4,30,26,20,28,6,12,14,2,18,8,14,18,6,2,26,24,22,28,4,12,10,20,8,0,30,16,18,0,10,14,4,8,20,30,28,2,22,24,12,16,6,26,4,24,12,20,0,22,16,6,8,26,14,10,30,28,2,18,24,10,2,30,28,26,8,20,0,14,12,6,18,4,16,22,26,22,14,28,24,2,6,18,10,0,30,8,16,12,4,20,12,30,28,18,22,6,0,16,24,4,26,14,2,8,20,10,20,4,16,8,14,12,2,10,30,22,18,28,6,24,26,0,0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,28,20,8,16,18,30,26,12,2,24,0,4,22,14,10,6);void add_uint64(int a,uint b0,uint b1){uint o0=v[a]+b0;uint o1=v[a+1]+b1;if(v[a]>0xFFFFFFFFu-b0){o1++;}v[a]=o0;v[a+1]=o1;}void add_uint64(int a,int b){add_uint64(a,v[b],v[b+1]);}void B2B_G(int a,int b,int c,int d,int ix,int iy){add_uint64(a,b);add_uint64(a,m[ix],m[ix+1]);uint xor0=v[d]^ v[a];uint xor1=v[d+1]^ v[a+1];v[d]=xor1;v[d+1]=xor0;add_uint64(c,d);xor0=v[b]^ v[c];xor1=v[b+1]^ v[c+1];v[b]=(xor0>>24)^(xor1<<8);v[b+1]=(xor1>>24)^(xor0<<8);add_uint64(a,b);add_uint64(a,m[iy],m[iy+1]);xor0=v[d]^ v[a];xor1=v[d+1]^ v[a+1];v[d]=(xor0>>16)^(xor1<<16);v[d+1]=(xor1>>16)^(xor0<<16);add_uint64(c,d);xor0=v[b]^ v[c];xor1=v[b+1]^ v[c+1];v[b]=(xor1>>31)^(xor0<<1);v[b+1]=(xor0>>31)^(xor1<<1);}void main(){int i;uint uv_x=uint(gl_FragCoord.x);uint uv_y=uint(gl_FragCoord.y);uint x_pos=uv_x % 256u;uint y_pos=uv_y % 256u;uint x_index=(uv_x-x_pos)/256u;uint y_index=(uv_y-y_pos)/256u;m[0]=(x_pos ^(y_pos<<8)^((uWork0.b ^ x_index)<<16)^((uWork0.a ^ y_index)<<24));m[1]=(uWork1.r ^(uWork1.g<<8)^(uWork1.b<<16)^(uWork1.a<<24));m[2]=uHash0[0];m[3]=uHash0[1];m[4]=uHash0[2];m[5]=uHash0[3];m[6]=uHash1[0];m[7]=uHash1[1];m[8]=uHash1[2];m[9]=uHash1[3];for(i=0;i<12;i++){B2B_G(0,8,16,24,SIGMA82[i*16+0],SIGMA82[i*16+1]);B2B_G(2,10,18,26,SIGMA82[i*16+2],SIGMA82[i*16+3]);B2B_G(4,12,20,28,SIGMA82[i*16+4],SIGMA82[i*16+5]);B2B_G(6,14,22,30,SIGMA82[i*16+6],SIGMA82[i*16+7]);B2B_G(0,10,20,30,SIGMA82[i*16+8],SIGMA82[i*16+9]);B2B_G(2,12,22,24,SIGMA82[i*16+10],SIGMA82[i*16+11]);B2B_G(4,14,16,26,SIGMA82[i*16+12],SIGMA82[i*16+13]);B2B_G(6,8,18,28,SIGMA82[i*16+14],SIGMA82[i*16+15]);}if((BLAKE2B_IV32_1 ^ v[1]^ v[17])>0xFFFFFE00u){fragColor=vec4(float(x_index+1u)/255.,float(y_index+1u)/255.,float(x_pos)/255.,float(y_pos)/255.);}}"),Un.compileShader(Bn);const Fn=Un.createProgram();function _n(n){try{return{hash:fn(n.hash)}}catch(n){}return null}Un.attachShader(Fn,mn),Un.attachShader(Fn,Bn),Un.linkProgram(Fn);let En="";async function Sn(n){const t=await function(n,t=1){In.width=In.height=256<<t;const r=function(n){let t="";for(let r=n.length;r>0;r-=2)t+=n.slice(r-2,r);return t}(bn(n));return Un.useProgram(Fn),Un.viewport(0,0,Un.drawingBufferWidth,Un.drawingBufferHeight),Un.clearColor(0,0,0,1),Un.uniform4uiv(Un.getUniformLocation(Fn,"uHash0"),new Uint32Array([parseInt(r.slice(56,64),16),parseInt(r.slice(48,56),16),parseInt(r.slice(40,48),16),parseInt(r.slice(32,40),16)])),Un.uniform4uiv(Un.getUniformLocation(Fn,"uHash1"),new Uint32Array([parseInt(r.slice(24,32),16),parseInt(r.slice(16,24),16),parseInt(r.slice(8,16),16),parseInt(r.slice(0,8),16)])),new Promise((n=>{const t=new Uint8Array(4),r=new Uint8Array(4);requestAnimationFrame((function e(){crypto.getRandomValues(t),crypto.getRandomValues(r),Un.uniform4uiv(Un.getUniformLocation(Fn,"uWork0"),Array.from(t)),Un.uniform4uiv(Un.getUniformLocation(Fn,"uWork1"),Array.from(r)),Un.clear(Un.COLOR_BUFFER_BIT),Un.drawArrays(Un.TRIANGLE_STRIP,0,4);const o=new Uint8Array(Un.drawingBufferWidth*Un.drawingBufferHeight*4);Un.readPixels(0,0,Un.drawingBufferWidth,Un.drawingBufferHeight,Un.RGBA,Un.UNSIGNED_BYTE,o);for(let e=0;e<o.length;e+=4)if(0!==o[e]){const i=vn(r,4),a=vn(new Uint8Array([o[e+2],o[e+3],t[2]^o[e]-1,t[3]^o[e+1]-1]),4);return void n(fn(i+a))}requestAnimationFrame(e)}))}))}(n);if(!pn(n,t,0xfffffe00n))throw new Error(`Generated work '${bn(t)}' is invalid`);return t}async function Cn(n,t,r,e,o){const i=An(n),a=await Sn(t||i),u={type:"state"};return u.account=xn(i),u.previous=bn(t||new Uint8Array(32)),u.representative=xn(r),u.balance=o.toString(10),u.work=bn(a),u.link=bn(e),u.signature=bn(ln(n,function(n){let t=BigInt(n.balance).toString(16);for(;t.length<32;)t="0"+t;const r=C.blake2bInit(32,null);return C.blake2bUpdate(r,fn("0000000000000000000000000000000000000000000000000000000000000006")),C.blake2bUpdate(r,An(n.account)),C.blake2bUpdate(r,fn(n.previous)),C.blake2bUpdate(r,An(n.representative)),C.blake2bUpdate(r,fn(t)),C.blake2bUpdate(r,fn(n.link)),C.blake2bFinal(r)}(u))),u}function Gn(n){if(!En)throw new Error("API URL is invalid");return new Promise(((t,r)=>{const e=JSON.stringify(n);fetch(En,{method:"POST",headers:{"Content-Type":"application/json","Content-Length":String(e.length)},body:e}).then((n=>{const r=n.json();t(r)})).catch((n=>{r(n)}))}))}function Hn(n){return!!n&&!n.hasOwnProperty("error")}function Dn(n){const t=new Error("").stack.split("\n")[2].replace(/^\s+at\s+(.+?)\s.+/g,"$1"),r=t.substr(t.lastIndexOf(".")+1).trim();console.warn(`API call '${r}' failed with: '${n}'`)}function Mn(n){if(!n.startsWith("https")&&!n.startsWith("http"))throw new Error("Invalid API URL");En=n}async function Rn(n){const t=xn(n),r=await Gn({action:"account_info",account:t});return Hn(r)?function(n){try{return{blockCount:parseInt(n.block_count),frontier:fn(n.frontier),representativeBlock:fn(n.representative_block),modificationTimestamp:parseInt(n.modified_timestamp)}}catch(n){}return null}(r):(Dn(r.error),null)}async function Ln(n){const t=xn(n),r=await Gn({action:"accounts_balances",accounts:[t]});return Hn(r)?function(n){try{const t=Object.values(n.balances)[0];return{balance:BigInt(t.balance),pending:BigInt(t.pending)}}catch(n){}return null}(r):(Dn(r.error),null)}async function Pn(n){const t=xn(n),r=await Gn({action:"account_representative",account:t});return Hn(r)?function(n){try{return{account:cn(n.representative)}}catch(n){}return null}(r):(Dn(r.error),null)}async function Wn(n,t=-1){const r=xn(n),e=await Gn({action:"account_history",account:r,count:t,raw:!1});return Hn(e)?function(n){try{if(Array.isArray(n.history)){const t={history:[]};for(const r of n.history)t.history.push({hash:fn(r.hash),amount:BigInt(r.amount),account:cn(r.account),action:"send"===r.type?kn.SEND:kn.RECEIVE});return t}}catch(n){}return null}(e):(Dn(e.error),null)}async function jn(n,t=-1){const r=xn(n),e=await Gn({action:"accounts_pending",accounts:[r],count:t,threshold:1,source:!0});return Hn(e)?function(n){try{const t={blocks:[]},r=Object.values(n.blocks)[0];for(const[n,e]of Object.entries(r)){const{amount:r,source:o}=e,i={amount:BigInt(r),hash:fn(n),source:cn(o)};t.blocks.push(i)}return t}catch(n){}return null}(e):(Dn(e.error),null)}async function On(n,t,r,e){const o=await Cn(n,null,t,r,e),i=await Gn({action:"process",json_block:"true",subtype:"open",block:o});return Hn(i)?_n(i):(Dn(i.error),null)}async function Tn(n,t,r,e){const o=An(n),i=await Wn(o),a=await Ln(o);if(!i||0==i.history.length)return On(n,t,r,e);const u=e+a.balance,c=(await Rn(o)).frontier,l=await Cn(n,c,t,r,u),s=await Gn({action:"process",json_block:"true",subtype:"receive",block:l});return Hn(s)?_n(s):(Dn(s.error),null)}async function $n(n,t,r){const e=An(n),o=await Rn(e),i=await Ln(e),a=await Pn(e),u=i.balance-r;if(i.balance<=0n||u<0n)return null;const c=o.frontier,l=await Cn(n,c,a.account,t,u),s=await Gn({action:"process",json_block:"true",subtype:"send",block:l});return Hn(s)?_n(s):(Dn(s.error),null)}export{bn as bytesToHex,hn as decimalToHex,xn as getAccountAddress,Ln as getAccountBalance,Wn as getAccountHistory,Rn as getAccountInfo,jn as getAccountPending,Pn as getAccountRepresentative,yn as getAmountFromRaw,wn as getPrivateKey,An as getPublicKey,dn as getRawFromAmount,fn as hexToBytes,gn as isSeedValid,pn as isWorkValid,On as openAccount,Tn as receiveAccount,$n as sendAccount,Mn as setAPIURL};
